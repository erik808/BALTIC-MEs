%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /projects/jmmp/dbruciaf/NEMO/CHECKOUTS_RELEASE-4.0-HEAD/NEMO_4.0-HEAD_test_MEs/tools/DOMAINcfg/src/zgrloc.F90
Compiled : 04/29/22  10:43:42
Compiler : Version 8.3.4
Ftnlx    : Version 8318 (libcif 83016)
Target   : x86-64
Command  : ftn_driver.exe -hcpu=haswell -hstatic -D__CRAYXC -D__CRAY_HASWELL
           -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries -ozgrloc.o
           -I/projects/jmmp/dbruciaf/NEMO/CHECKOUTS_RELEASE-4.0-HEAD/NEMO_4.0-HE
           AD_test_MEs/tools/DOMAINcfg/BLD/inc -sreal64 -sinteger32 -Ovector0
           -hfp0 -O0 -hflex_mp=intolerant -eCID
           -I/opt/cray/netcdf-hdf5parallel/4.3.2/CRAY/83/include
           -I/opt/cray/hdf5-parallel/1.8.13/CRAY/83/include
           -I/common/moci/modules/packages/XIOS/2.0/24708/952/inc
           -I/common/moci/modules/packages/oasis3-mct/2.0/24708/1765/build/lib/m
           ct
           -I/common/moci/modules/packages/oasis3-mct/2.0/24708/1765/build/lib/p
           smile.MPI1 -c -I/opt/cray/cce/8.3.4/craylibs/x86-64/include
           -I/opt/cray/netcdf-hdf5parallel/4.3.2/CRAY/83/include
           -I/opt/cray/hdf5-parallel/1.8.13/CRAY/83/include
           -I/opt/cray/libsci/13.0.1/CRAY/83/haswell/include
           -I/opt/cray/mpt/7.0.4/gni/mpich2-cray/83/include
           -I/opt/cray/rca/1.0.0-2.0502.60530.1.62.ari/include
           -I/opt/cray/alps/5.2.4-2.0502.9774.31.11.ari/include
           -I/opt/cray/xpmem/0.1-2.0502.64982.5.3.ari/include
           -I/opt/cray/gni-headers/4.0-1.0502.10859.7.8.ari/include
           -I/opt/cray/dmapp/7.0.1-1.0502.11080.8.76.ari/include
           -I/opt/cray/pmi/5.0.5-1.0000.10300.134.8.ari/include
           -I/opt/cray/ugni/6.0-1.0502.10863.8.29.ari/include
           -I/opt/cray/udreg/2.3.2-1.0502.10518.2.17.ari/include
           -I/opt/cray/cce/8.3.4/craylibs/x86-64/pkgconfig/../include
           -I/opt/cray/cce/8.3.4/craylibs/x86-64/include
           -I/opt/cray/wlm_detect/1.0-1.0502.64649.2.1.ari/include
           -I/opt/cray/krca/1.0.0-2.0502.63139.4.31.ari/include
           -I/opt/cray-hss-devel/7.2.0/include /projects/jmmp/dbruciaf/NEMO/CHEC
           KOUTS_RELEASE-4.0-HEAD/NEMO_4.0-HEAD_test_MEs/tools/DOMAINcfg/src/zgr
           loc.F90

ftnlx report
------------
Source   : /projects/jmmp/dbruciaf/NEMO/CHECKOUTS_RELEASE-4.0-HEAD/tools_r4.0-HEAD_dev_MEs/DOMAINcfg/BLD/tmp//projects/jmmp/dbruciaf/NEMO/CHECKOUTS_RELEASE-4.0-HEAD/NEMO_4.0-HEAD_test_MEs/tools/DOMAINcfg/src/zgrloc.F90
Date     : 04/29/2022  10:43:43


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    MODULE zgrloc
    2.       !!==============================================================================
    3.       !!                       ***  MODULE zgrmes   ***
    4.       !! Ocean initialization : Multiple Enveloped s coordinate (MES)
    5.       !!==============================================================================
    6.       !!  NEMO      4.0  ! 2021-07  (D. Bruciaferri)   
    7.       !!----------------------------------------------------------------------
    8.       !
    9.       USE oce               ! ocean variables
   10.       USE dom_oce           ! ocean domain
                 ^                                
ftn-1193 ftn: CAUTION ZGRLOC, File = zgrloc.F90, Line = 10, Column = 8 
  Module "PAR_KIND" is indirectly used in module "DOM_OCE" and is from file
  "/projects/jmmp/dbruciaf/NEMO/CHECKOUTS_RELEASE-4.0-HEAD/tools_r4.0-HEAD_dev_MEs/DOMAINcfg/BLD/tmp/par_kind.o".  That file no
  longer exists.

                 ^                                
ftn-1193 ftn: CAUTION ZGRLOC, File = zgrloc.F90, Line = 10, Column = 8 
  Module "PAR_OCE" is indirectly used in module "DOM_OCE" and is from file
  "/projects/jmmp/dbruciaf/NEMO/CHECKOUTS_RELEASE-4.0-HEAD/tools_r4.0-HEAD_dev_MEs/DOMAINcfg/BLD/tmp/par_oce.o".  That file no
  longer exists.

   11.       USE depth_e3          ! depth <=> e3
   12.       USE closea            ! closed seas
   13.       USE mes               ! MEs-coordinates
   14.       !
   15.       USE in_out_manager    ! I/O manager
                 ^                               
ftn-1193 ftn: CAUTION ZGRLOC, File = zgrloc.F90, Line = 15, Column = 8 
  Module "NC4INTERFACE" is indirectly used in module "IN_OUT_MANAGER" and is from file
  "/projects/jmmp/dbruciaf/NEMO/CHECKOUTS_RELEASE-4.0-HEAD/tools_r4.0-HEAD_dev_MEs/DOMAINcfg/BLD/tmp/nc4interface.o".  That file no
  longer exists.

   16.       USE iom               ! I/O library
                 ^                               
ftn-1193 ftn: CAUTION ZGRLOC, File = zgrloc.F90, Line = 16, Column = 8 
  Module "IOM_NF90" is indirectly used in module "IOM" and is from file
  "/projects/jmmp/dbruciaf/NEMO/CHECKOUTS_RELEASE-4.0-HEAD/tools_r4.0-HEAD_dev_MEs/DOMAINcfg/BLD/tmp/iom_nf90.o".  That file no
  longer exists.

                 ^                               
ftn-1193 ftn: CAUTION ZGRLOC, File = zgrloc.F90, Line = 16, Column = 8 
  Module "IOM_DEF" is indirectly used in module "IOM" and is from file
  "/projects/jmmp/dbruciaf/NEMO/CHECKOUTS_RELEASE-4.0-HEAD/tools_r4.0-HEAD_dev_MEs/DOMAINcfg/BLD/tmp/iom_def.o".  That file no
  longer exists.

   17.       USE lbclnk            ! ocean lateral boundary conditions (or mpp link)
   18.       USE lib_mpp           ! distributed memory computing library
   19.       USE wrk_nemo          ! Memory allocation
   20.       USE timing            ! Timing
   21.    
   22.       IMPLICIT NONE
   23.       PRIVATE
   24.    
   25.       PUBLIC   zgr_loc        ! called by zgrmes.F90
   26.       !
   27.       ! INPUT GLOBAL VERTICAL COORDINATE SYSTEM
   28.       !
   29.       REAL(wp), POINTER, DIMENSION(:)     :: e3t_1d_in  , e3w_1d_in   !: ref. scale factors (m)
   30.       REAL(wp), POINTER, DIMENSION(:)     :: gdept_1d_in, gdepw_1d_in !: ref. depth (m)
   31.       !
   32.       REAL(wp), POINTER, DIMENSION(:,:)   :: mbathy_in
   33.       !
   34.       REAL(wp), POINTER, DIMENSION(:,:,:) :: e3t_in, e3u_in , e3v_in , e3f_in !: scale factors [m]
   35.       REAL(wp), POINTER, DIMENSION(:,:,:) :: e3w_in, e3uw_in, e3vw_in         !:   -      -
   36.       ! 
   37.       REAL(wp), POINTER, DIMENSION(:,:,:) :: gdept_in, gdepw_in               !: depths [m]
   38.       !
   39.       !! * Substitutions
   40.    #  include "vectopt_loop_substitute.h90"
   41.    
   42.    CONTAINS
   43.    
   44.    ! =====================================================================================================
   45.    
   46.       SUBROUTINE zgr_loc
   47.          !!---------------------------------------------------------------------
   48.          !!              ***  ROUTINE zgr_loc  ***
   49.          !!
   50.          !! ** Purpose : Wrap the steps to generate a localised vertical 
   51.          !!              coordinate systems
   52.          !!----------------------------------------------------------------------
   53.          INTEGER  ::   ji, jj, jk     ! dummy loop index
   54.          !-----------------------------------------------------------------------
   55.          !
   56.          CALL wrk_alloc( jpk, gdept_1d_in, gdepw_1d_in, e3t_1d_in  , e3w_1d_in)
   57.          CALL wrk_alloc( jpi, jpj, mbathy_in)
   58.          CALL wrk_alloc( jpi, jpj, jpk, gdept_in, gdepw_in, e3t_in, e3w_in)
   59.          CALL wrk_alloc( jpi, jpj, jpk, e3u_in  , e3v_in  , e3f_in, e3uw_in, e3vw_in)
   60.          !
   61.          ! Reading the input vertical grid that will be used globally
   62.          CALL zgr_dom_read
   63.          ! Creating the local cooridnate system within the global input vertical grid
   64.          IF ( ln_mes ) CALL zgr_mes_local
   65.          !
   66.          CALL wrk_dealloc( jpk, gdept_1d_in, gdepw_1d_in, e3t_1d_in  , e3w_1d_in)
   67.          CALL wrk_dealloc( jpi, jpj, mbathy_in)
   68.          CALL wrk_dealloc( jpi, jpj, jpk, gdept_in, gdepw_in, e3t_in, e3w_in)
   69.          CALL wrk_dealloc( jpi, jpj, jpk, e3u_in  , e3v_in  , e3f_in, e3uw_in, e3vw_in)
   70.    
   71.       END SUBROUTINE zgr_loc
ftn-5002 ftn: NOTE File = zgrloc.F90, Line = 71 
  Local variable "JI" is declared but neither defined nor used.

ftn-5002 ftn: NOTE File = zgrloc.F90, Line = 71 
  Local variable "JJ" is declared but neither defined nor used.

ftn-5002 ftn: NOTE File = zgrloc.F90, Line = 71 
  Local variable "JK" is declared but neither defined nor used.

   72.    
   73.    ! =====================================================================================================
   74.    
   75.       SUBROUTINE zgr_dom_read
   76.         !!---------------------------------------------------------------------
   77.         !!              ***  ROUTINE zgr_dom_read  ***
   78.         !!
   79.         !! ** Purpose :   Read the vertical information in the domain configuration file
   80.         !!
   81.         !!----------------------------------------------------------------------
   82.         INTEGER  ::   jk     ! dummy loop index
   83.         INTEGER  ::   inum   ! local logical unit
   84.         REAL(WP) ::   z_cav
   85.         REAL(wp), DIMENSION(jpi,jpj) ::   z2d   ! 2D workspace
   86.         !!----------------------------------------------------------------------
   87.         !
   88.         IF(lwp) THEN
   89.           WRITE(numout,*)
   90.           WRITE(numout,*) '   zgr_dom_read : read the vertical coordinates in domain_cfg_global.nc file'
   91.           WRITE(numout,*) '   ~~~~~~~~'
   92.         ENDIF
   93.         !
   94.         CALL iom_open( 'domain_cfg_global.nc', inum )
   95.         !
   96.         !                          !* ocean cavities under iceshelves
   97.         CALL iom_get( inum, 'ln_isfcav', z_cav )
   98.         IF( z_cav == 0._wp ) THEN   ;   ln_isfcav = .false.   ;   ELSE   ;   ln_isfcav = .true.   ;   ENDIF
   99.         !
  100.         !                          !* vertical scale factors
  101.         CALL iom_get( inum, jpdom_unknown, 'e3t_1d'  , e3t_1d_in ) ! 1D reference coordinate
  102.         CALL iom_get( inum, jpdom_unknown, 'e3w_1d'  , e3w_1d_in )
  103.         !
  104.         CALL iom_get( inum, jpdom_global, 'bottom_level' , mbathy_in )     ! 2D mbathy
  105.         !
  106.         CALL iom_get( inum, jpdom_global, 'e3t_0'  , e3t_in  )     ! 3D coordinate
  107.         CALL iom_get( inum, jpdom_global, 'e3u_0'  , e3u_in  )
  108.         CALL iom_get( inum, jpdom_global, 'e3v_0'  , e3v_in  )
  109.         CALL iom_get( inum, jpdom_global, 'e3f_0'  , e3f_in  )
  110.         CALL iom_get( inum, jpdom_global, 'e3w_0'  , e3w_in  )
  111.         CALL iom_get( inum, jpdom_global, 'e3uw_0' , e3uw_in )
  112.         CALL iom_get( inum, jpdom_global, 'e3vw_0' , e3vw_in )
  113.         !
  114.         !                          !* depths
  115.         !                                   !- old depth definition (obsolescent feature)
  116.         IF(  iom_varid( inum, 'gdept_1d', ldstop = .FALSE. ) > 0  .AND.  &
  117.            & iom_varid( inum, 'gdepw_1d', ldstop = .FALSE. ) > 0  .AND.  &
  118.            & iom_varid( inum, 'gdept_0' , ldstop = .FALSE. ) > 0  .AND.  &
  119.            & iom_varid( inum, 'gdepw_0' , ldstop = .FALSE. ) > 0    ) THEN
  120.            CALL ctl_warn( 'zgr_dom_read : old definition of depths and scale factors used ', & 
  121.               &           '           depths at t- and w-points read in the domain configuration file')
  122.            CALL iom_get( inum, jpdom_unknown, 'gdept_1d', gdept_1d_in )   
  123.            CALL iom_get( inum, jpdom_unknown, 'gdepw_1d', gdepw_1d_in )
  124.            CALL iom_get( inum, jpdom_global , 'gdept_0' , gdept_in )
  125.            CALL iom_get( inum, jpdom_global , 'gdepw_0' , gdepw_in )
  126.            !
  127.         ELSE                                !- depths computed from e3. scale factors
  128.            CALL e3_to_depth( e3t_1d_in, e3w_1d_in, gdept_1d_in, gdepw_1d_in )    ! 1D reference depth
  129.            CALL e3_to_depth( e3t_in   , e3w_in   , gdept_in   , gdepw_in    )    ! 3D depths
  130.            IF(lwp) THEN
  131.              WRITE(numout,*)
  132.              WRITE(numout,*) '              GLOBAL reference 1D z-coordinate depth and scale factors:'
  133.              WRITE(numout, "(9x,' level  gdept_1d  gdepw_1d  e3t_1d   e3w_1d  ')" )
  134.              WRITE(numout, "(10x, i4, 4f9.2)" ) ( jk, gdept_1d_in(jk), gdepw_1d_in(jk), e3t_1d_in(jk), e3w_1d_in(jk), jk = 1, jpk )
  135.            ENDIF
  136.         ENDIF
  137.         !
  138.         CALL iom_close( inum )
  139.         !
  140.       END SUBROUTINE zgr_dom_read
ftn-5002 ftn: NOTE File = zgrloc.F90, Line = 140 
  Local variable "Z2D" is declared but neither defined nor used.

  141.    
  142.    ! =====================================================================================================
  143.    
  144.       SUBROUTINE zgr_mes_local
  145.         !!---------------------------------------------------------------------
  146.         !!              ***  ROUTINE zgr_dom_merge  ***
  147.         !!
  148.         !! ** Purpose :   Create a local MEs grid within a gloabal grid 
  149.         !!                using different vertical coordinates.
  150.         !!
  151.         !!----------------------------------------------------------------------
  152.         INTEGER                      ::   ji, jj, jk ! dummy loop index
  153.         INTEGER                      ::   inum       ! local logical unit
  154.         REAL(wp), DIMENSION(jpi,jpj) ::   l2g_wgt    ! weigths for computing model
  155.                                                      ! levels in transition area
  156.         !!----------------------------------------------------------------------
  157.    
  158.         IF(lwp) THEN
  159.           WRITE(numout,*)
  160.           WRITE(numout,*) '   zgr_mes_merge : read the vertical coordinates in domain_cfg_global.nc file'
  161.           WRITE(numout,*) '   ~~~~~~~~'
  162.         ENDIF
  163.         !
  164.         CALL iom_open( 'bathy_meter.nc', inum )
  165.         CALL iom_get( inum, jpdom_data, 's2z_msk', l2g_msk)
  166.         CALL iom_get( inum, jpdom_data, 's2z_wgt', l2g_wgt)
  167.    
  168.         DO jj = 1,jpj
  169.            DO ji = 1,jpi
  170.               SELECT CASE (INT(l2g_msk(ji,jj)))
  171.                 CASE (0) ! global zps area
  172.                      mbathy (ji,jj  ) = mbathy_in(ji,jj)
  173.                      gdept_0(ji,jj,:) = gdept_in(ji,jj,:)
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 173 
  A loop starting at line 173 was not vectorized because it contains a call to a subroutine or function on line 173.

  174.                      gdepw_0(ji,jj,:) = gdepw_in(ji,jj,:)
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 174 
  A loop starting at line 174 was not vectorized because it contains a call to a subroutine or function on line 174.

  175.                      e3t_0  (ji,jj,:) = e3t_in (ji,jj,:)
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 175 
  A loop starting at line 175 was not vectorized because it contains a call to a subroutine or function on line 175.

  176.                      e3w_0  (ji,jj,:) = e3w_in (ji,jj,:)
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 176 
  A loop starting at line 176 was not vectorized because it contains a call to a subroutine or function on line 176.

  177.                      e3u_0  (ji,jj,:) = e3u_in (ji,jj,:)
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 177 
  A loop starting at line 177 was not vectorized because it contains a call to a subroutine or function on line 177.

  178.                      e3v_0  (ji,jj,:) = e3v_in (ji,jj,:)
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 178 
  A loop starting at line 178 was not vectorized because it contains a call to a subroutine or function on line 178.

  179.                      e3f_0  (ji,jj,:) = e3f_in (ji,jj,:)
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 179 
  A loop starting at line 179 was not vectorized because it contains a call to a subroutine or function on line 179.

  180.                      e3uw_0 (ji,jj,:) = e3uw_in (ji,jj,:)
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 180 
  A loop starting at line 180 was not vectorized because it contains a call to a subroutine or function on line 180.

  181.                      e3vw_0 (ji,jj,:) = e3vw_in (ji,jj,:)
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 181 
  A loop starting at line 181 was not vectorized because it contains a call to a subroutine or function on line 181.

  182.                 CASE (1) ! MEs to zps transition area 
  183.                      gdept_0(ji,jj,:) =           l2g_wgt(ji,jj)   * gdept_0(ji,jj,:) + &
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 183 
  A loop starting at line 183 was not vectorized because it contains a call to a subroutine or function on line 183.

  184.                        &                ( 1._wp - l2g_wgt(ji,jj) ) * gdept_in(ji,jj,:)
  185.                      gdepw_0(ji,jj,:) =           l2g_wgt(ji,jj)   * gdepw_0(ji,jj,:) + &
ftn-6262 ftn: VECTOR File = zgrloc.F90, Line = 185 
  A loop starting at line 185 was not vectorized because it contains a call to a subroutine or function on line 185.

  186.                        &                ( 1._wp - l2g_wgt(ji,jj) ) * gdepw_in(ji,jj,:)
  187.                 CASE (2) ! MEs area
  188.                      CYCLE     
  189.               END SELECT
  190.            END DO
  191.         END DO
  192.         !
  193.         ! e3t, e3w for transition zone
  194.         ! as finite differences
  195.         DO jj = 1, jpj
  196.            DO ji = 1, jpi
  197.               IF ( l2g_msk(ji,jj) == 1._wp ) THEN
  198.                  DO jk = 1,jpkm1
  199.                     e3t_0(ji,jj,jk)   = gdepw_0(ji,jj,jk+1) - gdepw_0(ji,jj,jk)
  200.                     e3w_0(ji,jj,jk+1) = gdept_0(ji,jj,jk+1) - gdept_0(ji,jj,jk)
  201.                  ENDDO
  202.                  ! Surface
  203.                  jk = 1
  204.                  e3w_0(ji,jj,jk) = 2.0_wp * (gdept_0(ji,jj,1) - gdepw_0(ji,jj,1))
  205.                  !
  206.                  ! Bottom
  207.                  jk = jpk
  208.                  e3t_0(ji,jj,jk) = 2.0_wp * (gdept_0(ji,jj,jk) - gdepw_0(ji,jj,jk))
  209.               END IF
  210.            END DO
  211.         END DO
  212.         !
  213.         ! MBATHY transition zone
  214.         DO jj = 1, jpj
  215.            DO ji = 1, jpi
  216.               IF ( l2g_msk(ji,jj) == 1._wp ) THEN
  217.                  DO jk = 1, jpkm1
  218.                     IF( scobot(ji,jj) >= gdept_0(ji,jj,jk) ) mbathy(ji,jj) = MAX( 2, jk )
  219.                     IF( scobot(ji,jj) == 0.e0              ) mbathy(ji,jj) = 0
  220.                     IF( scobot(ji,jj) < 0.e0               ) mbathy(ji,jj) = INT( scobot(ji,jj)) ! do we need it?
  221.                  END DO
  222.               END IF
  223.            END DO
  224.         END DO
  225.         !
  226.         ! Computing e3u_0, e3v_0, e3f_0, e3uw_0, e3vw_0 
  227.         ! for transition zone
  228.         !
  229.         DO jj = 1, jpjm1
  230.            DO ji = 1, jpim1
  231.               IF ( l2g_msk(ji,jj) == 1._wp ) THEN
  232.                  DO jk = 1, jpk
  233.                     e3u_0(ji,jj,jk)=(MIN(1,mbathy(ji,jj))* e3t_0(ji,jj,jk)      +         &
  234.                                      MIN(1,mbathy(ji+1,jj))*e3t_0(ji+1,jj,jk) ) /         &
  235.                                      MAX( 1, MIN(1,mbathy(ji,jj))+MIN(1,mbathy(ji+1,jj))  )
  236.    
  237.                     e3v_0(ji,jj,jk)=(MIN(1,mbathy(ji,jj))* e3t_0(ji,jj,jk)      +         &
  238.                                      MIN(1,mbathy(ji,jj+1))*e3t_0(ji,jj+1,jk) ) /         &
  239.                                      MAX( 1, MIN(1,mbathy(ji,jj))+MIN(1,mbathy(ji,jj+1))  )
  240.    
  241.                     e3uw_0(ji,jj,jk)=(MIN(1,mbathy(ji,jj))* e3w_0(ji,jj,jk)      +         &
  242.                                       MIN(1,mbathy(ji+1,jj))*e3w_0(ji+1,jj,jk) ) /         &
  243.                                       MAX( 1, MIN(1,mbathy(ji,jj))+MIN(1,mbathy(ji+1,jj))  )
  244.    
  245.                     e3vw_0(ji,jj,jk)=(MIN(1,mbathy(ji,jj))* e3w_0(ji,jj,jk)      +         &
  246.                                       MIN(1,mbathy(ji,jj+1))*e3w_0(ji,jj+1,jk) ) /         &
  247.                                       MAX( 1, MIN(1,mbathy(ji,jj))+MIN(1,mbathy(ji,jj+1))  )
  248.    
  249.                     e3f_0(ji,jj,jk)=(MIN(1,mbathy(ji,jj))* e3t_0(ji,jj,jk)         +       &
  250.                                      MIN(1,mbathy(ji+1,jj))*e3t_0(ji+1,jj,jk)      +       &
  251.                                      MIN(1,mbathy(ji+1,jj+1))* e3t_0(ji+1,jj+1,jk) +       &
  252.                                      MIN(1,mbathy(ji,jj+1))*e3t_0(ji,jj+1,jk) )    /       &
  253.                                      MAX(  1, MIN(1,mbathy(ji,jj))+MIN(1,mbathy(ji,jj+1))  &
  254.                                    +   MIN(1,mbathy(ji+1,jj))+MIN(1,mbathy(ji+1,jj+1))  )
  255.                  END DO
  256.               END IF
  257.            END DO
  258.         END DO
  259.    
  260.       END SUBROUTINE zgr_mes_local
  261.    
  262.    END MODULE zgrloc


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
AGRIF_CFIXED in DOM_OCE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
AGRIF_ROOT in DOM_OCE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
CLOSEA
      Defined as:  No definitions.

      Used By:     ZGRLOC

Name  Messages
----  --------
CLO_BAT in CLOSEA
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
CTL_NAM in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
CTL_OPN in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
CTL_STOP in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
CTL_WARN in LIB_MPP
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 138, file zgrloc.F90)

Name  Messages
----  --------
DEPTH_E3
      Defined as:  No definitions.

      Used By:     ZGRLOC

Name  Messages
----  --------
DEPTH_TO_E3_1D in DEPTH_E3
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
DEPTH_TO_E3_3D in DEPTH_E3
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
DOM_CLO in CLOSEA
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
DOM_OCE
      Defined as:  No definitions.

      Used By:     ZGRLOC
                   ZGRLOC  (indirectly)
                   ZGRLOC  (indirectly)

Name  Messages
----  --------
DOM_OCE_ALLOC in DOM_OCE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
E3_TO_DEPTH_1D in DEPTH_E3
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 146, file zgrloc.F90)

Name  Messages
----  --------
E3_TO_DEPTH_3D in DEPTH_E3
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 147, file zgrloc.F90)

Name  Messages
----  --------
GET_NF90_SYMBOL in NC4INTERFACE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GET_UNIT in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
INT(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_MES_LOCAL in ZGRLOC (Line 188, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 238, file zgrloc.F90)

Name  Messages
----  --------
IN_OUT_MANAGER
      Defined as:  No definitions.

      Used By:     ZGRLOC
                   ZGRLOC  (indirectly)

Name  Messages
----  --------
IOM
      Defined as:  No definitions.

      Used By:     ZGRLOC

Name  Messages
----  --------
IOM_CLOSE in IOM
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 156, file zgrloc.F90)

Name  Messages
----  --------
IOM_CONTEXT_FINALIZE in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_DEF
      Defined as:  No definitions.

      Used By:     ZGRLOC  (indirectly)

Name  Messages
----  --------
IOM_G0D in IOM
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 115, file zgrloc.F90)

Name  Messages
----  --------
IOM_G0D_INTATT in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_G1D in IOM
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 119, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 120, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 140, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 141, file zgrloc.F90)

Name  Messages
----  --------
IOM_G2D in IOM
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 122, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 183, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 184, file zgrloc.F90)

Name  Messages
----  --------
IOM_G3D in IOM
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 124, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 125, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 126, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 127, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 128, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 129, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 130, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 142, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 143, file zgrloc.F90)

Name  Messages
----  --------
IOM_GETTIME in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_INIT in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_NF90
      Defined as:  No definitions.

      Used By:     ZGRLOC  (indirectly)

Name  Messages
----  --------
IOM_NF90_CLOSE in IOM_NF90
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_NF90_G0D in IOM_NF90
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_NF90_G123D in IOM_NF90
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_NF90_GETTIME in IOM_NF90
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_NF90_INTATT in IOM_NF90
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_NF90_OPEN in IOM_NF90
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_NF90_RP0123D in IOM_NF90
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_NF90_VARID in IOM_NF90
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_OPEN in IOM
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 112, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 182, file zgrloc.F90)

Name  Messages
----  --------
IOM_P0D in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_P1D in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_P2D in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_P3D in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_RP0D in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_RP1D in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_RP2D in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_RP3D in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_SETKT in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_SWAP in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_USE in IOM
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
IOM_VARID in IOM
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_DOM_READ in ZGRLOC (Line 134, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 135, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 136, file zgrloc.F90)
                   ZGR_DOM_READ in ZGRLOC (Line 137, file zgrloc.F90)

Name  Messages
----  --------
LBCLNK
      Defined as:  No definitions.

      Used By:     ZGRLOC  (indirectly)
                   ZGRLOC

Name  Messages
----  --------
LIB_MPP
      Defined as:  No definitions.

      Used By:     ZGRLOC  (indirectly)
                   ZGRLOC
                   ZGRLOC  (indirectly)

Name  Messages
----  --------
MAX(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_MES_LOCAL in ZGRLOC (Line 236, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 253, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 257, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 261, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 265, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 271, file zgrloc.F90)

Name  Messages
----  --------
MES
      Defined as:  No definitions.

      Used By:     ZGRLOC

Name  Messages
----  --------
MES_BUILD in MES
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MIN(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_MES_LOCAL in ZGRLOC (Line 251, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 252, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 253, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 253, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 255, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 256, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 257, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 257, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 259, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 260, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 261, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 261, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 263, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 264, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 265, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 265, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 267, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 268, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 269, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 270, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 271, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 271, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 272, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 272, file zgrloc.F90)

Name  Messages
----  --------
MPPBCAST_A_REAL in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPGATHER in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPMAX_A_INT in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPMAX_A_REAL in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPMAX_INT in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPMAX_REAL in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPMAX_REAL_MULTIPLE in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPMIN_A_INT in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPMIN_A_REAL in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPMIN_INT in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPMIN_REAL in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPRECV in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSCATTER in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSEND in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSTOP in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSUM_A_INT in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSUM_A_REAL in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSUM_A_REALDD in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSUM_INT in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSUM_REAL in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSUM_REALDD in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPPSYNC in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_COMM_FREE in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_INI_ICE in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_INI_NORTH in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_INI_ZNL in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LBC_NORTH_2D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LBC_NORTH_3D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LBC_NORTH_E in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LBC_NORTH_ICB in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_2D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_2D_9 in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_2D_E in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_2D_ICB in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_2D_MULTIPLE in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_3D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_3D_GATHER in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_BDY_2D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_BDY_3D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_SUM_2D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_LNK_SUM_3D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_MAXLOC2D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_MAXLOC3D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_MINLOC2D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPP_MINLOC3D in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MYNODE in LIB_MPP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
NC4INTERFACE
      Defined as:  No definitions.

      Used By:     ZGRLOC  (indirectly)
                   ZGRLOC  (indirectly)

Name  Messages
----  --------
OCE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

Name  Messages
----  --------
OCE_ALLOC in OCE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
PAR_KIND
      Defined as:  No definitions.

      Used By:     ZGRLOC  (indirectly)
                   ZGRLOC  (indirectly)
                   ZGRLOC  (indirectly)

Name  Messages
----  --------
PAR_OCE
      Defined as:  No definitions.

      Used By:     ZGRLOC  (indirectly)
                   ZGRLOC  (indirectly)
                   ZGRLOC  (indirectly)
                   ZGRLOC  (indirectly)

Name  Messages
----  --------
SET_NF90_DEF_VAR_CHUNKING in NC4INTERFACE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
SET_NF90_DEF_VAR_DEFLATE in NC4INTERFACE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TIMING
      Defined as:  No definitions.

      Used By:     ZGRLOC

Name  Messages
----  --------
TIMING_FINALIZE in TIMING
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TIMING_INIT in TIMING
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TIMING_RESET in TIMING
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TIMING_START in TIMING
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TIMING_STOP in TIMING
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_ALLOC_1DI in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_ALLOC_1DR in WRK_NEMO
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_LOC in ZGRLOC (Line 74, file zgrloc.F90)

Name  Messages
----  --------
WRK_ALLOC_2DI in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_ALLOC_2DR in WRK_NEMO
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_LOC in ZGRLOC (Line 75, file zgrloc.F90)

Name  Messages
----  --------
WRK_ALLOC_3DI in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_ALLOC_3DR in WRK_NEMO
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_LOC in ZGRLOC (Line 76, file zgrloc.F90)
                   ZGR_LOC in ZGRLOC (Line 77, file zgrloc.F90)

Name  Messages
----  --------
WRK_ALLOC_4DI in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_ALLOC_4DR in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_DEALLOC_1DI in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_DEALLOC_1DR in WRK_NEMO
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_LOC in ZGRLOC (Line 84, file zgrloc.F90)

Name  Messages
----  --------
WRK_DEALLOC_2DI in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_DEALLOC_2DR in WRK_NEMO
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_LOC in ZGRLOC (Line 85, file zgrloc.F90)

Name  Messages
----  --------
WRK_DEALLOC_3DI in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_DEALLOC_3DR in WRK_NEMO
      Defined as:  No definitions.

      Interface:   None

      Called By:   ZGR_LOC in ZGRLOC (Line 86, file zgrloc.F90)
                   ZGR_LOC in ZGRLOC (Line 87, file zgrloc.F90)

Name  Messages
----  --------
WRK_DEALLOC_4DI in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_DEALLOC_4DR in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_LIST in WRK_NEMO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WRK_NEMO
      Defined as:  No definitions.

      Used By:     ZGRLOC

Name  Messages
----  --------
ZGRLOC
      Defined as:  Module (line 1, file zgrloc.F90)

        Uses:      DOM_OCE
                   PAR_KIND  (indirectly)
                   PAR_OCE  (indirectly)
                   DEPTH_E3
                   CLOSEA
                   PAR_OCE  (indirectly)
                   DOM_OCE  (indirectly)
                   MES
                   IN_OUT_MANAGER
                   PAR_KIND  (indirectly)
                   NC4INTERFACE  (indirectly)
                   PAR_OCE  (indirectly)
                   IOM
                   NC4INTERFACE  (indirectly)
                   PAR_KIND  (indirectly)
                   PAR_OCE  (indirectly)
                   LIB_MPP  (indirectly)
                   LIB_MPP
                   IN_OUT_MANAGER  (indirectly)
                   IOM_NF90  (indirectly)
                   IOM_DEF  (indirectly)
                   LBCLNK  (indirectly)
                   LBCLNK
                   DOM_OCE  (indirectly)
                   LIB_MPP  (indirectly)
                   WRK_NEMO
                   TIMING

Name  Messages
----  --------
ZGR_DOM_READ in ZGRLOC
      Defined as:  Subroutine (line 93, file zgrloc.F90)

      Interface:   None

      Called By:   ZGR_LOC in ZGRLOC (Line 80, file zgrloc.F90)

      Calls:       CTL_WARN in LIB_MPP (Line 138, file zgrloc.F90)
                   E3_TO_DEPTH_1D in DEPTH_E3 (Line 146, file zgrloc.F90)
                   E3_TO_DEPTH_3D in DEPTH_E3 (Line 147, file zgrloc.F90)
                   IOM_CLOSE in IOM (Line 156, file zgrloc.F90)
                   IOM_G0D in IOM (Line 115, file zgrloc.F90)
                   IOM_G1D in IOM (Line 119, file zgrloc.F90)
                   IOM_G1D in IOM (Line 120, file zgrloc.F90)
                   IOM_G2D in IOM (Line 122, file zgrloc.F90)
                   IOM_G3D in IOM (Line 124, file zgrloc.F90)
                   IOM_G3D in IOM (Line 125, file zgrloc.F90)
                   IOM_G3D in IOM (Line 126, file zgrloc.F90)
                   IOM_G3D in IOM (Line 127, file zgrloc.F90)
                   IOM_G3D in IOM (Line 128, file zgrloc.F90)
                   IOM_G3D in IOM (Line 129, file zgrloc.F90)
                   IOM_G3D in IOM (Line 130, file zgrloc.F90)
                   IOM_G1D in IOM (Line 140, file zgrloc.F90)
                   IOM_G1D in IOM (Line 141, file zgrloc.F90)
                   IOM_G3D in IOM (Line 142, file zgrloc.F90)
                   IOM_G3D in IOM (Line 143, file zgrloc.F90)
                   IOM_OPEN in IOM (Line 112, file zgrloc.F90)
                   IOM_VARID in IOM (Line 134, file zgrloc.F90)
                   IOM_VARID in IOM (Line 135, file zgrloc.F90)
                   IOM_VARID in IOM (Line 136, file zgrloc.F90)
                   IOM_VARID in IOM (Line 137, file zgrloc.F90)

Name  Messages
----  --------
ZGR_LOC in ZGRLOC
      Defined as:  Subroutine (line 25, file zgrloc.F90)

      Interface:   None

      Calls:       ZGR_DOM_READ in ZGRLOC (Line 80, file zgrloc.F90)
                   ZGR_MES_LOCAL in ZGRLOC (Line 82, file zgrloc.F90)
                   WRK_ALLOC_1DR in WRK_NEMO (Line 74, file zgrloc.F90)
                   WRK_ALLOC_2DR in WRK_NEMO (Line 75, file zgrloc.F90)
                   WRK_ALLOC_3DR in WRK_NEMO (Line 76, file zgrloc.F90)
                   WRK_ALLOC_3DR in WRK_NEMO (Line 77, file zgrloc.F90)
                   WRK_DEALLOC_1DR in WRK_NEMO (Line 84, file zgrloc.F90)
                   WRK_DEALLOC_2DR in WRK_NEMO (Line 85, file zgrloc.F90)
                   WRK_DEALLOC_3DR in WRK_NEMO (Line 86, file zgrloc.F90)
                   WRK_DEALLOC_3DR in WRK_NEMO (Line 87, file zgrloc.F90)

Name  Messages
----  --------
ZGR_MES_LOCAL in ZGRLOC
      Defined as:  Subroutine (line 162, file zgrloc.F90)

      Interface:   None

      Called By:   ZGR_LOC in ZGRLOC (Line 82, file zgrloc.F90)

      Calls:       IOM_G2D in IOM (Line 183, file zgrloc.F90)
                   IOM_G2D in IOM (Line 184, file zgrloc.F90)
                   IOM_OPEN in IOM (Line 182, file zgrloc.F90)
                   INT(Intrinsic) (Line 188, file zgrloc.F90)
                   INT(Intrinsic) (Line 238, file zgrloc.F90)
                   MAX(Intrinsic) (Line 236, file zgrloc.F90)
                   MAX(Intrinsic) (Line 253, file zgrloc.F90)
                   MAX(Intrinsic) (Line 257, file zgrloc.F90)
                   MAX(Intrinsic) (Line 261, file zgrloc.F90)
                   MAX(Intrinsic) (Line 265, file zgrloc.F90)
                   MAX(Intrinsic) (Line 271, file zgrloc.F90)
                   MIN(Intrinsic) (Line 251, file zgrloc.F90)
                   MIN(Intrinsic) (Line 252, file zgrloc.F90)
                   MIN(Intrinsic) (Line 253, file zgrloc.F90)
                   MIN(Intrinsic) (Line 253, file zgrloc.F90)
                   MIN(Intrinsic) (Line 255, file zgrloc.F90)
                   MIN(Intrinsic) (Line 256, file zgrloc.F90)
                   MIN(Intrinsic) (Line 257, file zgrloc.F90)
                   MIN(Intrinsic) (Line 257, file zgrloc.F90)
                   MIN(Intrinsic) (Line 259, file zgrloc.F90)
                   MIN(Intrinsic) (Line 260, file zgrloc.F90)
                   MIN(Intrinsic) (Line 261, file zgrloc.F90)
                   MIN(Intrinsic) (Line 261, file zgrloc.F90)
                   MIN(Intrinsic) (Line 263, file zgrloc.F90)
                   MIN(Intrinsic) (Line 264, file zgrloc.F90)
                   MIN(Intrinsic) (Line 265, file zgrloc.F90)
                   MIN(Intrinsic) (Line 265, file zgrloc.F90)
                   MIN(Intrinsic) (Line 267, file zgrloc.F90)
                   MIN(Intrinsic) (Line 268, file zgrloc.F90)
                   MIN(Intrinsic) (Line 269, file zgrloc.F90)
                   MIN(Intrinsic) (Line 270, file zgrloc.F90)
                   MIN(Intrinsic) (Line 271, file zgrloc.F90)
                   MIN(Intrinsic) (Line 271, file zgrloc.F90)
                   MIN(Intrinsic) (Line 272, file zgrloc.F90)
                   MIN(Intrinsic) (Line 272, file zgrloc.F90)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
